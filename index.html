<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>FamTime — Prototipo Verde</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4CAF50">
<link rel="apple-touch-icon" href="icons/icon-192.png">
<style>
:root{
  --bg:#E8F5E9; --surface:#ffffff; --ink:#1B5E20; --muted:#2E7D32;
  --line:#C8E6C9; --brand:#4CAF50; --accent:#A5D6A7;
  --safe:env(safe-area-inset-bottom);
}
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;background:linear-gradient(180deg,var(--bg),#F1F8E9 60%,var(--bg));color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Quicksand,Arial}
.container{max-width:480px;margin:0 auto;padding:16px 14px calc(96px + var(--safe))}
h1{font-size:22px;margin:6px 0}h2{font-size:18px;margin:8px 0}p{margin:6px 0;color:var(--muted)}
.card{background:var(--surface);border:1px solid var(--line);border-radius:18px;padding:16px;margin:12px 0;box-shadow:0 6px 24px rgba(76,175,80,.12)}
.pill{display:inline-flex;align-items:center;gap:8px;background:#DCEDC8;color:#2E7D32;padding:8px 12px;border-radius:999px;font-weight:600}
.btn{width:100%;padding:14px;border-radius:14px;border:1px solid #8BC34A;background:#DCEDC8;color:#1B5E20;font-size:16px;cursor:pointer}
.btn.primary{background:var(--brand);border-color:#388E3C;color:#fff}
.btn.accent{background:#AED581;border-color:#9CCC65;color:#1B5E20}
.btn.muted{background:#E8F5E9;border-color:#C8E6C9;color:#2E7D32}
.btn:active{transform:scale(.99)}
.tiles{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.tile{padding:14px;border-radius:16px;background:#fff;border:1px solid var(--line);text-align:center;cursor:pointer}
.tile.active{outline:2px solid var(--brand)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.recipe{background:#fff;border:1px solid var(--line);border-radius:16px;padding:10px;display:flex;gap:10px;align-items:center}
.recipe-emoji{font-size:26px}
.recipe-meta{font-size:12px;color:#2E7D32}
.cal{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;background:#fff;border:1px solid var(--line);border-radius:16px;padding:10px}
.cal div{padding:10px;border-radius:10px;text-align:center;border:1px solid #E0F2F1;background:#F1F8E9}
.cal .today{background:#C8E6C9;border-color:#A5D6A7;font-weight:700}
.tabbar{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid var(--line);display:grid;grid-template-columns:repeat(5,1fr);gap:8px;padding:8px 12px calc(8px + var(--safe))}
.tab{border:none;background:#E8F5E9;color:#2E7D32;border:1px solid var(--line);border-radius:12px;padding:10px;font-size:12px}
.tab.active{background:var(--brand);border-color:#388E3C;color:#fff}
.hide{display:none!important}
.list .row{display:flex;justify-content:space-between;align-items:center;padding:12px;border:1px solid var(--line);border-radius:14px;background:#fff;margin:8px 0}
.badge{padding:4px 8px;border-radius:999px;background:#DCEDC8;color:#2E7D32;font-size:12px}
.progress{height:10px;background:#E8F5E9;border-radius:999px;overflow:hidden}
.progress>div{height:100%;background:#66BB6A;width:60%}
input,select,textarea{width:100%;padding:12px;border-radius:12px;border:1px solid var(--line);background:#fff;font:inherit}
</style>
</head>
<body>
<div class="container">
  <section id="home" class="card">
    <div class="pill">👋 Hola, familia</div>
    <h1>Hoy</h1>
    <div class="list">
      <div class="row"><span>Preparar lonchera</span><button class="badge">Checklist</button></div>
      <div class="row"><span>Revisar cuaderno</span><span class="badge">07:30</span></div>
      <div class="row"><span>Llevar uniforme deportivo</span><span class="badge">08:00</span></div>
    </div>
    <div class="card" style="margin:12px 0;background:#FFFDE7;border-color:#FFF9C4">
      <b>🥗 Receta del día</b>
      <div class="list"><div class="row"><span>Ensalada de pollo</span><button class="btn primary" style="width:auto" onclick="openRecipe('A')">Ver</button></div></div>
    </div>
    <div class="card" style="background:#E3F2FD;border-color:#BBDEFB">
      <b>🌟 Reto familiar</b>
      <p>5 porciones de frutas/verduras</p>
      <div class="progress"><div></div></div>
      <small>3 de 5 días</small>
    </div>
  </section>

  <section id="calendario" class="card hide">
    <div class="pill">📅 Calendario familiar</div>
    <h1>Octubre 2025</h1>
    <div class="cal" id="calGrid"></div>
    <div class="list">
      <div class="row"><span>Reunión de padres</span><span class="badge">Hoy 4:00 PM</span></div>
      <div class="row"><span>Control pediátrico</span><span class="badge">Mañana 10:00 AM</span></div>
    </div>
    <button class="btn accent" onclick="alert('Formulario de evento (demo)')">Agregar evento</button>
  </section>

  <section id="recetas" class="card hide">
    <div class="pill">🍎 Recetas saludables</div>
    <div class="tiles" id="filter">
      <div class="tile active" data-f="todas">Todas</div>
      <div class="tile" data-f="desayuno">Desayunos</div>
      <div class="tile" data-f="lonchera">Loncheras</div>
      <div class="tile" data-f="merienda">Meriendas</div>
    </div>
    <div class="grid2" id="recipeList"></div>
  </section>

  <section id="detalle" class="card hide">
    <div class="pill">📋 Receta</div>
    <h1 id="rTitle">—</h1>
    <p class="badge" id="rTag">—</p>
    <h2>Ingredientes</h2>
    <ul id="rIng"></ul>
    <h2>Preparación</h2>
    <ol id="rSteps"></ol>
    <button class="btn primary" onclick="go('home')">Hecho</button>
  </section>

  <section id="comunidad" class="card hide">
    <div class="pill">💬 Comunidad de padres</div>
    <div class="card"><b>María T</b> · <small>Hace 2h</small><p>¿Recetas verdes favoritas?</p><small>❤️ 12</small></div>
    <div class="card"><b>Carlos M</b> · <small>Hace 5h</small><p>Preparo snacks el domingo: palitos de zanahoria y hummus.</p><small>❤️ 24</small></div>
  </section>

  <section id="perfil" class="card hide">
    <div class="pill">👤 Perfil</div>
    <label>Alergias</label><input placeholder="Lactosa, Gluten">
    <label>Presupuesto semanal (S/)</label><input type="number" value="150">
    <label>Preferencias</label><input placeholder="Brócoli, Palta, Pavo">
    <button class="btn primary" onclick="alert('Preferencias guardadas (demo)')">Guardar</button>
  </section>
</div>

<nav class="tabbar">
  <button class="tab active" id="t-home" onclick="go('home')">Inicio</button>
  <button class="tab" id="t-calendario" onclick="go('calendario')">Calendario</button>
  <button class="tab" id="t-recetas" onclick="go('recetas')">Recetas</button>
  <button class="tab" id="t-comunidad" onclick="go('comunidad')">Comunidad</button>
  <button class="tab" id="t-perfil" onclick="go('perfil')">Perfil</button>
</nav>

<script>
if('serviceWorker' in navigator){ window.addEventListener('load',()=>navigator.serviceWorker.register('./sw.js')); }

const RECETAS=[
 {id:'A',emoji:'🥗',nombre:'Ensalada de pollo',tag:'lonchera',min:12,ing:['Pechuga cocida','Lechuga','Palta','Tomate','Aceite de oliva'],pas:['Corta todo','Mezcla','Aliña y sirve']},
 {id:'B',emoji:'🥣',nombre:'Avena con frutas',tag:'desayuno',min:5,ing:['Avena','Leche/alternativa','Fresas','Banano'],pas:['Calienta','Mezcla','Sirve']},
 {id:'C',emoji:'🌯',nombre:'Wrap integral',tag:'lonchera',min:15,ing:['Tortilla integral','Pollo','Zanahoria','Yogur SL'],pas:['Plancha el pollo','Rellena','Enrolla']},
 {id:'D',emoji:'🥤',nombre:'Smoothie verde',tag:'merienda',min:5,ing:['Espinaca','Manzana','Yogur SL'],pas:['Licúa','Sirve']}
];

function go(v){
  document.querySelectorAll('section').forEach(s=>s.classList.add('hide'));
  document.getElementById(v).classList.remove('hide');
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  const btn=document.getElementById('t-'+v); if(btn) btn.classList.add('active');
  if(v==='recetas') renderRecipes();
  if(v==='calendario') renderCalendar();
}
go('home');

function renderCalendar(){
  const grid=document.getElementById('calGrid'); grid.innerHTML='';
  for(let i=1;i<=35;i++){
    const c=document.createElement('div');
    c.textContent = i<=31? i : '';
    if(i===20) c.className='today';
    grid.appendChild(c);
  }
}

function renderRecipes(filter='todas'){
  const list=document.getElementById('recipeList'); list.innerHTML='';
  RECETAS.filter(r => filter==='todas' || r.tag===filter).forEach(r=>{
    const div=document.createElement('div'); div.className='recipe';
    div.innerHTML = '<div class="recipe-emoji">'+r.emoji+'</div>' +
      '<div style="flex:1"><b>'+r.nombre+'</b><div class="recipe-meta">'+r.tag+' • '+r.min+' min</div></div>' +
      '<button class="btn primary" style="width:auto">Ver</button>';
    div.querySelector('button').onclick = ()=>openRecipe(r.id);
    list.appendChild(div);
  });
}
document.getElementById('filter').addEventListener('click', e=>{
  if(!e.target.classList.contains('tile')) return;
  document.querySelectorAll('#filter .tile').forEach(t=>t.classList.remove('active'));
  e.target.classList.add('active');
  renderRecipes(e.target.dataset.f);
});

function openRecipe(id){
  const r=RECETAS.find(x=>x.id===id);
  document.getElementById('rTitle').textContent=r.nombre;
  document.getElementById('rTag').textContent=r.tag+' • '+r.min+' min';
  document.getElementById('rIng').innerHTML=r.ing.map(i=>'<li>'+i+'</li>').join('');
  document.getElementById('rSteps').innerHTML=r.pas.map(p=>'<li>'+p+'</li>').join('');
  go('detalle');
}
</script>
</body>
</html>
